
Global
  ARGV   - Parsed arguments
  CONFIG - Configuration
  SCREEN - Blessed screen
  COMP   - Blessed components
  USAGE  - Usage string

Global variables
  LAST_SEARCH    - Last query
  SOURCE         - Last query source
  STREAM_LIST    - Current stream list
  IS_PLAYING     - Whether its playing
  IS_PAUSED      - Whether mplayer is paused
  IS_INPUT       - Whether there is input

IO exit :promise<state>
  S
  process.exit

IO stop :promise<state>
  IS_PLAYING
  SOURCE
  Mplayer

IO pause :promise<state>
  IS_PAUSED
  SOURCE
  set_header
  set_title

PURE format_header

IO set_header : void !MODIFIES S.COMP.HEADER
  CONFIG
  IS_PAUSED
  COMP
  S

PURE format_title :string

IO set_title : void !MODIFIES S.SCR.TITLE
  IS_PLAYING
  S

IO display_rows : void !MODIFIES S.COMP.TABLE
  COMP
  S

IO query_streams :promise<Entry[]>
  Icecast
  Radio
  LAST_SEARCH
  SOURCE

PURE add_rows_padding
PURE icecast_list
PURE radio_list
PURE format_stream_list


IO search_streams :promise<State>
  LAST_SEARCH
  CURRENT_INDEX
  CONFIG
  COMP
  S

  format_stream_list
  display_rows
  set_header
  set_title
  

IO refresh_table
  search_streams

IO play_url
  IS_PLAYING
  IS_PAUSED
  Mplayer
  set_header
  set_title

IO toggle_input
  IS_INPUT
  COMP
  S
  set_header
  set_title

IO input_handler
  COMP
  search_stream
  toggle_input

IO set_events
  CURRENT_INDEX
  SOURCE
  CONFIG
  COMP
  S
  refresh_table
  play_url
  
IO init
  COMP
  S
  set_events
  search_streams

IO main
  ARGV
  console.log
  process.exit
  init


main()
  check arguments
  init

-------------------------------

exit
pause
stop

play_url
  :is_playing
  :is_paused
  set_header
  set_title

search_streams
  - toggle loading
  : last_search, current_index
  : stream_list
  > display_rows
  > set_header
  > set_title
  

refresh_table
  > search_streams

toggle_input
  - toggle input
  set_header
  set_title
  : is_input

input_handler
  - clear input
  > search_streams
  > toggle_input

init
  set_events
    exit
    pause
    stop
    Mplayer
    > toggle_input
    > play_url
    > refresh_table
    > input_handler
    
  > search_streams

